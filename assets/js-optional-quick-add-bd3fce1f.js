import{M as m}from"./modal-dialog-a2754344.js";import{q as o,a as n,g as d,e as a,x as u,s as l}from"./functions-24c9f5aa.js";import{P as p}from"./product-form-32ca35ea.js";import"./global-a82f9e0b.js";import"./UcoastEl-260a5367.js";import"./pubsub-54ee595b.js";import"./setup-cc6ab6b9.js";import"./shopify-f44b47c1.js";class c extends m{constructor(){super(),this.modalContent=o('[id^="QuickAddInfo-"]',this)}hide(t=!1){const e=n("cart-notification")||o("cart-drawer");e&&this.openedBy&&e.setActiveElement(this.openedBy),this.modalContent.innerHTML="",t&&(this.openedBy=void 0),super.hide()}show(t){t.setAttribute("aria-disabled","true"),t.classList.add("loading"),o(".loading-overlay__spinner",t).classList.remove("hidden"),fetch(d("data-product-url",t)).then(e=>e.text()).then(e=>{const i=new DOMParser().parseFromString(e,"text/html");this.productElement=o('section[id^="MainProduct-"]',i.documentElement),this.preventDuplicatedIDs(),this.removeDOMElements(),this.setInnerHTML(this.modalContent,this.productElement.innerHTML),window.Shopify&&window.Shopify.PaymentButton&&window.Shopify.PaymentButton.init(),window.ProductModel&&window.ProductModel.loadShopifyXR(),this.removeGalleryListSemantic(),this.updateImageSizes(),this.preventVariantURLSwitching(),super.show(t)}).finally(()=>{t.removeAttribute("aria-disabled"),t.classList.remove("loading"),o(".loading-overlay__spinner",t).classList.add("hidden")})}setInnerHTML(t,e){t.innerHTML=e,t.querySelectorAll("script").forEach(i=>{if(!i.parentNode)throw new Error("oldScriptTag.parentNode is null, cannot replace script");const r=document.createElement("script");Array.from(i.attributes).forEach(s=>{r.setAttribute(s.name,s.value)}),r.appendChild(document.createTextNode(i.innerHTML)),i.parentNode.replaceChild(r,i)})}preventVariantURLSwitching(){const t=this.modalContent.querySelector("variant-radios,variant-selects");t&&t.setAttribute("data-update-url","false")}removeDOMElements(){var e,i;if(!this.productElement)throw new Error("this.removeDOMElements called without this.productElement");(e=n("pickup-availability",this.productElement))==null||e.remove(),(i=n("product-modal",this.productElement))==null||i.remove();const t=a("modal-dialog",this.productElement);t&&t.forEach(r=>r.remove())}preventDuplicatedIDs(){if(!this.productElement)throw new Error("this.preventDuplicatedIDs called without this.productElement");const t=d("data-section",this.productElement);this.productElement.innerHTML=u(this.productElement.innerHTML,t,`quickadd-${t}`);const e=a("variant-selects, variant-radios, product-info",this.productElement);e==null||e.forEach(i=>{i.dataset.originalSection=t})}removeGalleryListSemantic(){const t=this.modalContent.querySelector('[id^="Slider-Gallery"]');t&&(t.setAttribute("role","presentation"),t.querySelectorAll('[id^="Slide-"]').forEach(e=>e.setAttribute("role","presentation")))}updateImageSizes(){const t=o(".product",this.modalContent);if(!t.classList.contains("product--columns"))return;const i=a(".product__media img",t);if(!i)return;let r="(min-width: 1000px) 715px, (min-width: 750px) calc((100vw - 11.5rem) / 2), calc(100vw - 4rem)";t.classList.contains("product--medium")?r=r.replace("715px","605px"):t.classList.contains("product--small")&&(r=r.replace("715px","495px")),i.forEach(s=>s.setAttribute("sizes",r))}}c.htmlSelector="quick-add-modal";l(c);l(p);
//# sourceMappingURL=js-optional-quick-add-bd3fce1f.js.map
