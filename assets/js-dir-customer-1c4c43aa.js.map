{"version":3,"file":"js-dir-customer-1c4c43aa.js","sources":["../src/scripts/customer/customer.ts","../src/entry/js-dir-customer.ts"],"sourcesContent":["import { Shopify } from '@/scripts/shopify'\nimport {\n\tcurrentTargetRequired,\n\tqsaRequired,\n\tqsOptional,\n\tqsRequired,\n\ttargetClosestOptional,\n} from '@/scripts/functions'\n\nconst selectors = {\n\tcustomerAddresses: '[data-customer-addresses]',\n\taddressCountrySelect: '[data-address-country-select]',\n\taddressContainer: '[data-address]',\n\ttoggleAddressButton: 'button[aria-expanded]',\n\tcancelAddressButton: 'button[type=\"reset\"]',\n\tdeleteAddressButton: 'button[data-confirm-message]',\n}\n\nconst attributes = {\n\texpanded: 'aria-expanded',\n\tconfirmMessage: 'data-confirm-message',\n}\n\nclass CustomerAddresses {\n\telements?: {\n\t\tcontainer: HTMLElement\n\t\taddressContainer: HTMLElement\n\t\tcancelButtons: NodeListOf<HTMLButtonElement>\n\t\tdeleteButtons: NodeListOf<HTMLButtonElement>\n\t\tcountrySelects: NodeListOf<HTMLSelectElement>\n\t\ttoggleButtons: NodeListOf<HTMLButtonElement>\n\t}\n\tconstructor() {\n\t\tthis.elements = this._getElements()\n\t\tthis._setupCountries()\n\t\tthis._setupEventListeners()\n\t}\n\n\t_getElements() {\n\t\tconst container = qsOptional(selectors.customerAddresses)\n\t\treturn container\n\t\t\t? {\n\t\t\t\t\tcontainer,\n\t\t\t\t\taddressContainer: qsRequired(selectors.addressContainer, container),\n\t\t\t\t\ttoggleButtons: qsaRequired<HTMLButtonElement>(selectors.toggleAddressButton),\n\t\t\t\t\tcancelButtons: qsaRequired<HTMLButtonElement>(\n\t\t\t\t\t\tselectors.cancelAddressButton,\n\t\t\t\t\t\tcontainer\n\t\t\t\t\t),\n\t\t\t\t\tdeleteButtons: qsaRequired<HTMLButtonElement>(\n\t\t\t\t\t\tselectors.deleteAddressButton,\n\t\t\t\t\t\tcontainer\n\t\t\t\t\t),\n\t\t\t\t\tcountrySelects: qsaRequired<HTMLSelectElement>(\n\t\t\t\t\t\tselectors.addressCountrySelect,\n\t\t\t\t\t\tcontainer\n\t\t\t\t\t),\n\t\t\t  }\n\t\t\t: undefined\n\t}\n\n\t_setupCountries() {\n\t\tif (Shopify && Shopify.CountryProvinceSelector && this.elements) {\n\t\t\t// eslint-disable-next-line no-new\n\t\t\t// shopify is ignoring this, so we have to ignore it too\n\t\t\t// @ts-ignore\n\t\t\tnew Shopify.CountryProvinceSelector('AddressCountryNew', 'AddressProvinceNew', {\n\t\t\t\thideElement: 'AddressProvinceContainerNew',\n\t\t\t})\n\t\t\tthis.elements.countrySelects.forEach((select: HTMLSelectElement) => {\n\t\t\t\tconst formId = select.dataset.formId\n\t\t\t\t// eslint-disable-next-line no-new\n\t\t\t\t// shopify is ignoring this, so we have to ignore it too\n\t\t\t\t// @ts-ignore\n\t\t\t\tnew Shopify.CountryProvinceSelector(\n\t\t\t\t\t`AddressCountry_${formId}`,\n\t\t\t\t\t`AddressProvince_${formId}`,\n\t\t\t\t\t{\n\t\t\t\t\t\thideElement: `AddressProvinceContainer_${formId}`,\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t})\n\t\t}\n\t}\n\n\t_setupEventListeners() {\n\t\tif (!this.elements) return\n\t\tthis.elements.toggleButtons.forEach((element: HTMLButtonElement) => {\n\t\t\telement.addEventListener('click', this._handleAddEditButtonClick)\n\t\t})\n\t\tthis.elements.cancelButtons.forEach((element: HTMLButtonElement) => {\n\t\t\telement.addEventListener('click', this._handleCancelButtonClick)\n\t\t})\n\t\tthis.elements.deleteButtons.forEach((element: HTMLButtonElement) => {\n\t\t\telement.addEventListener('click', this._handleDeleteButtonClick)\n\t\t})\n\t}\n\n\t_toggleExpanded(target: HTMLElement) {\n\t\ttarget.setAttribute(\n\t\t\tattributes.expanded,\n\t\t\t(target.getAttribute(attributes.expanded) === 'false').toString()\n\t\t)\n\t}\n\n\t_handleAddEditButtonClick = (event: Event) => {\n\t\tconst currentTarget = currentTargetRequired(event)\n\t\tthis._toggleExpanded(currentTarget)\n\t}\n\n\t_handleCancelButtonClick = (event: Event) => {\n\t\tconst currentTarget = targetClosestOptional(event, 'selectors.addressContainer')\n\t\tconst toggleEl = qsRequired(`[${attributes.expanded}]`, currentTarget)\n\t\tthis._toggleExpanded(toggleEl)\n\t}\n\n\t_handleDeleteButtonClick = (event: Event) => {\n\t\tconst currentTarget = currentTargetRequired(event)\n\t\tconst confirmMessage = currentTarget.getAttribute(attributes.confirmMessage)\n\t\tconst target = currentTarget.dataset.target\n\t\tif (!confirmMessage || !target) return\n\t\t// eslint-disable-next-line no-alert\n\t\tif (confirm(confirmMessage)) {\n\t\t\tShopify.postLink(target, {\n\t\t\t\tparameters: { _method: 'delete' },\n\t\t\t})\n\t\t}\n\t}\n}\n\nexport function initializeCustomerAddresses() {\n\twindow.addEventListener('load', () => {\n\t\ttypeof CustomerAddresses !== 'undefined' && new CustomerAddresses();\n\t});\n}\n","import { initializeCustomerAddresses } from '@/scripts/customer/customer';\n\ninitializeCustomerAddresses();\n"],"names":["selectors","attributes","CustomerAddresses","event","currentTarget","currentTargetRequired","targetClosestOptional","toggleEl","qsRequired","confirmMessage","target","Shopify","container","qsOptional","qsaRequired","select","formId","element","initializeCustomerAddresses"],"mappings":"kHASA,MAAMA,EAAY,CACjB,kBAAmB,4BACnB,qBAAsB,gCACtB,iBAAkB,iBAClB,oBAAqB,wBACrB,oBAAqB,uBACrB,oBAAqB,8BACtB,EAEMC,EAAa,CAClB,SAAU,gBACV,eAAgB,sBACjB,EAEA,MAAMC,CAAkB,CASvB,aAAc,CAyEd,KAAA,0BAA6BC,GAAiB,CACvC,MAAAC,EAAgBC,EAAsBF,CAAK,EACjD,KAAK,gBAAgBC,CAAa,CAAA,EAGnC,KAAA,yBAA4BD,GAAiB,CACtC,MAAAC,EAAgBE,EAAsBH,EAAO,4BAA4B,EACzEI,EAAWC,EAAW,IAAIP,EAAW,YAAaG,CAAa,EACrE,KAAK,gBAAgBG,CAAQ,CAAA,EAG9B,KAAA,yBAA4BJ,GAAiB,CACtC,MAAAC,EAAgBC,EAAsBF,CAAK,EAC3CM,EAAiBL,EAAc,aAAaH,EAAW,cAAc,EACrES,EAASN,EAAc,QAAQ,OACjC,CAACK,GAAkB,CAACC,GAEpB,QAAQD,CAAc,GACzBE,EAAQ,SAASD,EAAQ,CACxB,WAAY,CAAE,QAAS,QAAS,CAAA,CAChC,CACF,EA7FK,KAAA,SAAW,KAAK,eACrB,KAAK,gBAAgB,EACrB,KAAK,qBAAqB,CAC3B,CAEA,cAAe,CACR,MAAAE,EAAYC,EAAWb,EAAU,iBAAiB,EACxD,OAAOY,EACJ,CACA,UAAAA,EACA,iBAAkBJ,EAAWR,EAAU,iBAAkBY,CAAS,EAClE,cAAeE,EAA+Bd,EAAU,mBAAmB,EAC3E,cAAec,EACdd,EAAU,oBACVY,CACD,EACA,cAAeE,EACdd,EAAU,oBACVY,CACD,EACA,eAAgBE,EACfd,EAAU,qBACVY,CACD,CAEA,EAAA,MACJ,CAEA,iBAAkB,CACbD,GAAWA,EAAQ,yBAA2B,KAAK,WAIlD,IAAAA,EAAQ,wBAAwB,oBAAqB,qBAAsB,CAC9E,YAAa,6BAAA,CACb,EACD,KAAK,SAAS,eAAe,QAASI,GAA8B,CAC7D,MAAAC,EAASD,EAAO,QAAQ,OAI9B,IAAIJ,EAAQ,wBACX,kBAAkBK,IAClB,mBAAmBA,IACnB,CACC,YAAa,4BAA4BA,GAC1C,CAAA,CACD,CACA,EAEH,CAEA,sBAAuB,CACjB,KAAK,WACV,KAAK,SAAS,cAAc,QAASC,GAA+B,CAC3DA,EAAA,iBAAiB,QAAS,KAAK,yBAAyB,CAAA,CAChE,EACD,KAAK,SAAS,cAAc,QAASA,GAA+B,CAC3DA,EAAA,iBAAiB,QAAS,KAAK,wBAAwB,CAAA,CAC/D,EACD,KAAK,SAAS,cAAc,QAASA,GAA+B,CAC3DA,EAAA,iBAAiB,QAAS,KAAK,wBAAwB,CAAA,CAC/D,EACF,CAEA,gBAAgBP,EAAqB,CAC7BA,EAAA,aACNT,EAAW,UACVS,EAAO,aAAaT,EAAW,QAAQ,IAAM,SAAS,SAAS,CAAA,CAElE,CAyBD,CAEO,SAASiB,GAA8B,CACtC,OAAA,iBAAiB,OAAQ,IAAM,CAC9B,OAAAhB,EAAsB,KAAe,IAAIA,CAAkB,CAClE,CACF,CCpIAgB,EAA4B"}