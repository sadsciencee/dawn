{"version":3,"file":"slider-component-dc930296.js","sources":["../src/scripts/theme/slider-component.ts"],"sourcesContent":["import { currentTargetRequired, qsaRequired, qsOptional, qsRequired } from '@/scripts/functions'\nimport { type SlideChangedEvent } from '@/scripts/types/events'\nimport { UcoastEl } from '@/scripts/core/UcoastEl'\n\nexport function isSliderComponent(obj: HTMLElement): obj is SliderComponent {\n\tif (!obj) return false\n\tif (obj.localName !== 'slider-component') return false\n\treturn true\n}\n\nexport class SliderComponent extends UcoastEl {\n\tstatic htmlSelector = 'slider-component'\n\tslider: HTMLElement\n\tsliderItems: NodeListOf<HTMLElement>\n\tsliderItemsToShow?: HTMLElement[]\n\tsliderItemOffset?: number\n\tslidesPerPage?: number\n\ttotalPages?: number\n\tcurrentPage?: number = 1\n\tslideScrollPosition?: number\n\tenableSliderLooping: boolean\n\tcurrentPageElement?: HTMLElement\n\tpageTotalElement?: HTMLElement\n\tprevButton?: HTMLButtonElement\n\tnextButton?: HTMLButtonElement\n\tconstructor() {\n\t\tsuper()\n\t\tthis.slider = qsRequired('[id^=\"Slider-\"]', this)\n\t\tthis.sliderItems = qsaRequired('[id^=\"Slide-\"]', this)\n\t\tthis.enableSliderLooping = false\n\t\tthis.currentPageElement = qsOptional('.slider-counter--current', this)\n\t\tthis.pageTotalElement = qsOptional('.slider-counter--total', this)\n\t\tthis.prevButton = qsOptional('button[name=\"previous\"]', this)\n\t\tthis.nextButton = qsOptional('button[name=\"next\"]', this)\n\n\t\tthis.initPages()\n\t\tconst resizeObserver = new ResizeObserver((_entries: ResizeObserverEntry[]) =>\n\t\t\tthis.initPages()\n\t\t)\n\t\tresizeObserver.observe(this.slider)\n\n\t\tthis.slider.addEventListener('scroll', this.update.bind(this))\n\t\tthis.prevButton?.addEventListener('click', this.onButtonClick.bind(this))\n\t\tthis.nextButton?.addEventListener('click', this.onButtonClick.bind(this))\n\t}\n\n\tinitPages() {\n\t\tthis.sliderItemsToShow = Array.from(this.sliderItems).filter(\n\t\t\t(element) => element.clientWidth > 0\n\t\t)\n\t\tif (this.sliderItemsToShow.length < 2) return\n\t\tthis.sliderItemOffset =\n\t\t\tthis.sliderItemsToShow[1].offsetLeft - this.sliderItemsToShow[0].offsetLeft\n\t\tthis.slidesPerPage = Math.floor(\n\t\t\t(this.slider.clientWidth - this.sliderItemsToShow[0].offsetLeft) / this.sliderItemOffset\n\t\t)\n\t\tthis.totalPages = this.sliderItemsToShow.length - this.slidesPerPage + 1\n\t\tthis.update()\n\t}\n\n\tresetPages() {\n\t\tthis.sliderItems = this.querySelectorAll('[id^=\"Slide-\"]')\n\t\tthis.initPages()\n\t}\n\n\tcreateSlideChangedEvent(): SlideChangedEvent {\n\t\tconst currentPage = this.currentPage\n\t\tif (!currentPage)\n\t\t\tthrow new Error('cannot createSlideChangedEvent - currentPage is undefined')\n\t\tif (!this.sliderItemsToShow)\n\t\t\tthrow new Error('cannot createSlideChangedEvent - sliderItemsToShow is undefined')\n\t\tconst currentElement = this.sliderItemsToShow[currentPage - 1]\n\t\tif (!currentElement)\n\t\t\tthrow new Error('cannot createSlideChangedEvent - currentElement is undefined')\n\t\treturn new CustomEvent('slideChanged', {\n\t\t\tdetail: {\n\t\t\t\tcurrentPage,\n\t\t\t\tcurrentElement,\n\t\t\t},\n\t\t})\n\t}\n\n\tupdate() {\n\t\t// Temporarily prevents unneeded updates resulting from variant changes\n\t\t// This should be refactored as part of https://github.com/Shopify/dawn/issues/2057\n\t\tif (!this.slider || !this.nextButton) return\n\n\t\tconst previousPage = this.currentPage\n\t\tif (!this.sliderItemOffset || this.sliderItemOffset === 0) {\n\t\t\tthis.currentPage = 1\n\t\t} else {\n\t\t\tthis.currentPage = Math.round(this.slider.scrollLeft / this.sliderItemOffset) + 1\n\t\t}\n\n\t\tif (this.currentPageElement && this.pageTotalElement) {\n\t\t\tthis.currentPageElement.textContent = `${this.currentPage}`\n\t\t\tthis.pageTotalElement.textContent = `${this.totalPages}`\n\t\t}\n\n\t\tif (this.currentPage != previousPage) {\n\t\t\tif (this.sliderItemsToShow) {\n\t\t\t\tthis.dispatchEvent(this.createSlideChangedEvent())\n\t\t\t} else {\n\t\t\t\tthrow new Error('sliderItemsToShow is undefined')\n\t\t\t}\n\t\t}\n\n\t\tif (this.enableSliderLooping) return\n\n\t\tif (\n\t\t\tthis.prevButton &&\n\t\t\tthis.sliderItemsToShow &&\n\t\t\tthis.sliderItemsToShow.length &&\n\t\t\tthis.isSlideVisible(this.sliderItemsToShow[0]) &&\n\t\t\tthis.slider.scrollLeft === 0\n\t\t) {\n\t\t\tthis.prevButton.setAttribute('disabled', 'disabled')\n\t\t} else if (this.prevButton) {\n\t\t\tthis.prevButton.removeAttribute('disabled')\n\t\t}\n\n\t\tif (\n\t\t\tthis.nextButton &&\n\t\t\tthis.sliderItemsToShow &&\n\t\t\tthis.sliderItemsToShow.length > 0 &&\n\t\t\tthis.isSlideVisible(this.sliderItemsToShow[this.sliderItemsToShow.length - 1])\n\t\t) {\n\t\t\tthis.nextButton.setAttribute('disabled', 'disabled')\n\t\t} else if (this.nextButton) {\n\t\t\tthis.nextButton.removeAttribute('disabled')\n\t\t}\n\t}\n\n\tisSlideVisible(element: HTMLElement, offset = 0) {\n\t\tconst lastVisibleSlide = this.slider.clientWidth + this.slider.scrollLeft - offset\n\t\treturn (\n\t\t\telement.offsetLeft + element.clientWidth <= lastVisibleSlide &&\n\t\t\telement.offsetLeft >= this.slider.scrollLeft\n\t\t)\n\t}\n\n\tonButtonClick(event: MouseEvent) {\n\t\tevent.preventDefault()\n\t\tconst currentTarget = currentTargetRequired(event)\n\t\tif (!(currentTarget instanceof HTMLButtonElement)) return\n\t\tif (!this.sliderItemOffset) return\n\t\tconst step = currentTarget.dataset.step ? parseInt(currentTarget.dataset.step) : 1\n\t\tthis.slideScrollPosition =\n\t\t\tcurrentTarget.name === 'next'\n\t\t\t\t? this.slider.scrollLeft + step * this.sliderItemOffset\n\t\t\t\t: this.slider.scrollLeft - step * this.sliderItemOffset\n\t\tthis.setSlidePosition(this.slideScrollPosition)\n\t}\n\n\tsetSlidePosition(position: number) {\n\t\tthis.slider.scrollTo({\n\t\t\tleft: position,\n\t\t})\n\t}\n}\n"],"names":["isSliderComponent","obj","SliderComponent","UcoastEl","qsRequired","qsaRequired","qsOptional","_entries","_a","_b","element","currentPage","currentElement","previousPage","offset","lastVisibleSlide","event","currentTarget","currentTargetRequired","step","position"],"mappings":"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"}