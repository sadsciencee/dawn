{"version":3,"file":"setup-cc6ab6b9.js","sources":["../src/scripts/setup.ts"],"sourcesContent":["import { CountryProvinceSelector } from './shopify';\nimport { type WindowProductModel } from '@/scripts/optional/product-model';\n\n// this file used to have a bunch of functions as well as the uCoastShopify class\n// we have a new file that's just Shopify that will be used for all theme-defined functions\n// the remaining code here is to deal with the window.Shopify object which can be extremely variable\n// TODO: refactor existing Shopify object to be more extendable so that we can use window.Shopify functions from within the class\n\n\ntype PaymentButtonReference = {\n\tinit: () => void\n} & typeof HTMLElement\n\n\n\nexport type ModelViewerUIReference = {\n\tpause: () => void;\n\tnew (modelViewEl: HTMLElement): ModelViewerUIReference;\n} & typeof HTMLElement;\n\nexport class uCoastShopify {\n\tshop?: string\n\tlocale?: string\n\tcurrency?: {\n\t\tactive: string\n\t\trate: string\n\t}\n\tcountry?: string\n\ttheme?: {\n\t\tname: string\n\t\tid: number\n\t\ttheme_store_id: number\n\t\trole: string\n\t\thandle: string\n\t\tstyle: {\n\t\t\tid: string\n\t\t\thandle: string\n\t\t}\n\t}\n\tcdnHost?: string\n\troutes?: {\n\t\troot: string\n\t}\n\tanalytics?: {\n\t\treplayQueue: any[]\n\t}\n\tmodules?: boolean\n\trecaptchaV3?: {\n\t\tsiteKey: string\n\t}\n\tCountryProvinceSelector: typeof CountryProvinceSelector\n\tPaymentButton?: PaymentButtonReference\n\tModelViewerUI?: ModelViewerUIReference\n\tdesignMode: boolean\n\tloadFeatures?: (\n\t\tarray: { name: string; version: string, onLoad: (error: Error | Error[]) => void }[],\n\t) => void\n\tcustomerPrivacy?: {\n\t\tshouldShowGDPRBanner: () => boolean\n\t\tshouldShowCCPABanner: () => boolean\n\t\tuserCanBeTracked: () => boolean\n\t\tgetTrackingConsent: () => string\n\t\tsetTrackingConsent: (consent: boolean, callback: (error?: string) => void) => void\n\t\tpreferencesProcessingAllowed: () => boolean\n\t\tthirdPartyMarketingAllowed: () => boolean\n\t\tanalyticsProcessingAllowed: () => boolean\n\t\tcurrentVisitorConsent: () => string\n\t\tuserDataCanBeSold: () => boolean\n\t}\n\n\tconstructor(config: Partial<uCoastShopify>) {\n\t\tthis.shop = config.shop\n\t\tthis.locale = config.locale\n\t\tthis.currency = config.currency\n\t\tthis.country = config.country\n\t\tthis.theme = config.theme\n\t\tthis.cdnHost = config.cdnHost\n\t\tthis.routes = config.routes\n\t\tthis.analytics = config.analytics\n\t\tthis.modules = config.modules\n\t\tthis.PaymentButton = config.PaymentButton\n\t\tthis.recaptchaV3 = config.recaptchaV3\n\t\tthis.designMode = config.designMode ?? false\n\t\tthis.CountryProvinceSelector = CountryProvinceSelector\n\t}\n\n\tpublic bind(fn: Function, scope: CountryProvinceSelector) {\n\t\treturn function () {\n\t\t\treturn fn.apply(scope, arguments)\n\t\t}\n\t}\n\n\tpublic setSelectorByValue(selector: HTMLSelectElement, value: string) {\n\t\tfor (let i = 0, count = selector.options.length; i < count; i++) {\n\t\t\tlet option = selector.options[i]\n\t\t\tif (value == option.value || value == option.innerHTML) {\n\t\t\t\tselector.selectedIndex = i\n\t\t\t\treturn i\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic addListener = function (\n\t\ttarget: HTMLElement,\n\t\teventName: string,\n\t\tcallback: (event: Event) => void\n\t) {\n\t\tif (!(target instanceof HTMLElement)) return\n\t\tif (target.addEventListener) {\n\t\t\ttarget.addEventListener(eventName, callback, false)\n\t\t} else if ((target as any).attachEvent) {\n\t\t\t;(target as any).attachEvent('on' + eventName, callback)\n\t\t}\n\t}\n\n\tpublic postLink(path: string, options: { parameters: { _method?: string } }) {\n\t\tif (!options || !options.parameters || !options.parameters._method) return\n\t\toptions = options || {}\n\t\tlet method = options['parameters']['_method'] || 'post'\n\t\tlet form = document.createElement('form')\n\t\tform.setAttribute('method', method)\n\t\tform.setAttribute('action', path)\n\t\tlet hiddenField = document.createElement('input')\n\t\thiddenField.setAttribute('type', 'hidden')\n\t\thiddenField.setAttribute('name', '_method')\n\t\thiddenField.setAttribute('value', method)\n\t\tform.appendChild(hiddenField)\n\n\t\tdocument.body.appendChild(form)\n\t\tform.submit()\n\t\tdocument.body.removeChild(form)\n\t}\n}\n\ntype routesType = {\n\tcart_add_url: string\n\tcart_change_url: string\n\tcart_update_url: string\n\tcart_url: string\n\tpredictive_search_url: string\n\troot: string\n}\n\ntype cartStringsType = {\n\terror: string\n\tquantityError: string\n}\n\ntype variantStringsType = {\n\taddToCart: string\n\tsoldOut: string\n\tunavailable: string\n\tunavailable_with_option: string\n\tpreorder: string\n\tcomingSoon: string\n}\n\ntype accessibilityStringsType = {\n\timageAvailable: string\n\tshareSuccess: string\n\tpauseSlideshow: string\n\tplaySlideshow: string\n\trecipientFormExpanded: string\n\trecipientFormCollapsed: string\n}\n\nexport interface uCoastWindow extends Window {\n\troutes: routesType\n\tShopify: uCoastShopify\n\tklaviyoPopupWaitingForConsent?: boolean\n\tdemoMode?: boolean\n\tcartStrings: cartStringsType\n\tshopUrl: string\n\tvariantStrings: variantStringsType\n\taccessibilityStrings: accessibilityStringsType\n\tShopifyXR?: {\n\t\tsetupXRElements: () => void\n\t\taddModels: (json: any) => void\n\t}\n\tProductModel?: WindowProductModel\n\tloadHls?: () => void\n}\n\ndeclare let window: uCoastWindow\n\nexport const routes: routesType =\n\twindow && window?.routes\n\t\t? window.routes\n\t\t: {\n\t\t\t\tcart_add_url: '/cart/add',\n\t\t\t\tcart_change_url: '/cart/change',\n\t\t\t\tcart_update_url: '/cart/update',\n\t\t\t\tcart_url: '/cart',\n\t\t\t\tpredictive_search_url: '/search/suggest',\n\t\t\t\troot: '/',\n\t\t  }\n\nexport const cartStrings: cartStringsType =\n\twindow && window?.cartStrings\n\t\t? window.cartStrings\n\t\t: {\n\t\t\t\terror: '',\n\t\t\t\tquantityError: '',\n\t\t  }\n\nexport const shopUrl = window && window?.shopUrl ? window.shopUrl : '/'\n\nexport const variantStrings: variantStringsType =\n\twindow && window?.variantStrings\n\t\t? window.variantStrings\n\t\t: {\n\t\t\t\taddToCart: '',\n\t\t\t\tsoldOut: '',\n\t\t\t\tpreorder: '',\n\t\t\t\tcomingSoon: '',\n\t\t\t\tunavailable: '',\n\t\t\t\tunavailable_with_option: '',\n\t\t  }\n\nexport const accessibilityStrings: accessibilityStringsType = {\n\timageAvailable: '',\n\tshareSuccess: '',\n\tpauseSlideshow: '',\n\tplaySlideshow: '',\n\trecipientFormExpanded: '',\n\trecipientFormCollapsed: '',\n}\n\nexport function initShopify() {\n\treturn new uCoastShopify(window && window?.Shopify ? window.Shopify : { designMode: false })\n}\n"],"names":["routes"],"mappings":"8BAyLO,MAAMA,EACZ,SAAU,qBAAQ,QACf,OAAO,OACP,CACA,aAAc,YACd,gBAAiB,eACjB,gBAAiB,eACjB,SAAU,QACV,sBAAuB,kBACvB,KAAM,GACN"}