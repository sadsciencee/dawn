import{q as s,g as a,a as l,t as c,s as h}from"./functions-de1108d3.js";import{U as d}from"./UcoastEl-5d53ad84.js";import{r as f,t as y}from"./global-86a0ee8d.js";class u extends d{constructor(){if(super(),!this.hasAttribute("available"))return;const t=s("template",this).content,i=t.firstElementChild;(!t||!i||i===null)&&console.error("No template content found in PickupAvailability"),this.errorHtml=i==null?void 0:i.cloneNode(!0),this.onClickRefreshList=this.onClickRefreshList.bind(this);const r=a("data-variant-id",this);this.fetchAvailability(r)}fetchAvailability(e){let t=this.dataset.rootUrl;t||(t=window.location.origin),t.endsWith("/")||(t=t+"/");const i=`${t}variants/${e}/?section_id=pickup-availability`;fetch(i).then(r=>r.text()).then(r=>{const o=new DOMParser().parseFromString(r,"text/html"),n=s(".shopify-section",o.documentElement);this.renderPreview(n)}).catch(r=>{console.error(r);const o=this.querySelector("button");o&&o.removeEventListener("click",this.onClickRefreshList),this.renderError()})}onClickRefreshList(e){const t=a("variant-id",this);this.fetchAvailability(t)}renderError(){if(this.innerHTML="",!this.errorHtml)throw new Error("renderError thrown too early");this.appendChild(this.errorHtml),s("button",this).addEventListener("click",this.onClickRefreshList)}renderPreview(e){const t=l("pickup-availability-drawer");t&&t.remove();const i=l("pickup-availability-preview",e);if(!i){this.innerHTML="",this.removeAttribute("available");return}this.innerHTML=i.outerHTML,this.setAttribute("available","");const r=e.querySelector("pickup-availability-drawer");if(r instanceof Node)document.body.appendChild(r);else throw new Error("No pickup-availability-drawer found in sectionInnerHTML");const o=this.querySelector("button");o&&o.addEventListener("click",n=>{const b=s("pickup-availability-drawer"),m=c(n);b.show(m)})}}u.htmlSelector="pickup-availability";class p extends d{constructor(){super(),this.onBodyClick=this.handleBodyClick.bind(this),this.opener=s("button",this),this.opener.addEventListener("click",()=>{this.hide()}),this.addEventListener("keyup",e=>{e.code.toUpperCase()==="ESCAPE"&&this.hide()})}handleBodyClick(e){const t=c(e);t!=this&&!t.closest("pickup-availability-drawer")&&t.id!="ShowPickupAvailabilityDrawer"&&this.hide()}hide(){this.removeAttribute("open"),document.body.removeEventListener("click",this.onBodyClick),document.body.classList.remove("overflow-hidden"),f(this.focusElement)}show(e){this.focusElement=e,this.setAttribute("open",""),document.body.addEventListener("click",this.onBodyClick),document.body.classList.add("overflow-hidden"),y(this)}}p.htmlSelector="pickup-availability-drawer";h(p);h(u);
//# sourceMappingURL=js-optional-pickup-availability-e7861339.js.map
