{"version":3,"file":"js-optional-localization-form-e4f4436b.js","sources":["../src/scripts/optional/localization-form.ts","../src/entry/js-optional-localization-form.ts"],"sourcesContent":["import { currentTargetRequired, qsRequired, relatedTargetOptional } from '@/scripts/functions';\nimport { type EventWithRelatedTarget } from '@/scripts/types/theme';\nimport { UcoastEl } from '@/scripts/core/UcoastEl';\n\nexport class LocalizationForm extends UcoastEl {\n\tstatic htmlSelector = 'localization-form'\n\telements: {\n\t\tinput: HTMLInputElement\n\t\tbutton: HTMLButtonElement\n\t\tpanel: HTMLElement\n\t}\n\tconstructor() {\n\t\tsuper()\n\t\tthis.elements = {\n\t\t\tinput: qsRequired('input[name=\"locale_code\"], input[name=\"country_code\"]', this),\n\t\t\tbutton: qsRequired('button', this),\n\t\t\tpanel: qsRequired('.disclosure__list-wrapper', this),\n\t\t}\n\t\tthis.elements.button.addEventListener('click', this.openSelector.bind(this))\n\t\tthis.elements.button.addEventListener('focusout', this.closeSelector.bind(this))\n\t\tthis.addEventListener('keyup', this.onContainerKeyUp.bind(this))\n\n\t\tthis.querySelectorAll('a').forEach((item) =>\n\t\t\titem.addEventListener('click', this.onItemClick.bind(this))\n\t\t)\n\t}\n\n\thidePanel() {\n\t\tthis.elements.button.setAttribute('aria-expanded', 'false')\n\t\tthis.elements.panel.setAttribute('hidden', 'true')\n\t}\n\n\tonContainerKeyUp(event: KeyboardEvent) {\n\t\tif (event.code.toUpperCase() !== 'ESCAPE') return\n\n\t\tif (this.elements.button.getAttribute('aria-expanded') == 'false') return\n\t\tthis.hidePanel()\n\t\tevent.stopPropagation()\n\t\tthis.elements.button.focus()\n\t}\n\n\tonItemClick(event: MouseEvent) {\n\t\tevent.preventDefault()\n\t\tconst form = this.querySelector('form')\n\t\tthis.elements.input.value =\n\t\t\tcurrentTargetRequired(event).dataset.value ?? this.elements.input.value\n\t\tif (form) form.submit()\n\t}\n\n\topenSelector() {\n\t\tthis.elements.button.focus()\n\t\tthis.elements.panel.toggleAttribute('hidden')\n\t\tthis.elements.button.setAttribute(\n\t\t\t'aria-expanded',\n\t\t\t(this.elements.button.getAttribute('aria-expanded') === 'false').toString()\n\t\t)\n\t}\n\n\tcloseSelector(event: EventWithRelatedTarget) {\n    const relatedTarget = relatedTargetOptional(event)\n\t\tconst isChild =\n\t\t\tthis.elements.panel.contains(relatedTarget) ||\n\t\t\tthis.elements.button.contains(relatedTarget)\n\t\tif (!event.relatedTarget || !isChild) {\n\t\t\tthis.hidePanel()\n\t\t}\n\t}\n}\n","import { safeDefineElement } from '@/scripts/functions';\nimport { LocalizationForm } from '@/scripts/optional/localization-form';\n\nsafeDefineElement(LocalizationForm)\n"],"names":["LocalizationForm","UcoastEl","qsRequired","item","event","form","currentTargetRequired","relatedTarget","relatedTargetOptional","isChild","safeDefineElement"],"mappings":"4GAIO,MAAMA,UAAyBC,CAAS,CAO9C,aAAc,CACP,QACN,KAAK,SAAW,CACf,MAAOC,EAAW,wDAAyD,IAAI,EAC/E,OAAQA,EAAW,SAAU,IAAI,EACjC,MAAOA,EAAW,4BAA6B,IAAI,CAAA,EAE/C,KAAA,SAAS,OAAO,iBAAiB,QAAS,KAAK,aAAa,KAAK,IAAI,CAAC,EACtE,KAAA,SAAS,OAAO,iBAAiB,WAAY,KAAK,cAAc,KAAK,IAAI,CAAC,EAC/E,KAAK,iBAAiB,QAAS,KAAK,iBAAiB,KAAK,IAAI,CAAC,EAE1D,KAAA,iBAAiB,GAAG,EAAE,QAASC,GACnCA,EAAK,iBAAiB,QAAS,KAAK,YAAY,KAAK,IAAI,CAAC,CAAA,CAE5D,CAEA,WAAY,CACX,KAAK,SAAS,OAAO,aAAa,gBAAiB,OAAO,EAC1D,KAAK,SAAS,MAAM,aAAa,SAAU,MAAM,CAClD,CAEA,iBAAiBC,EAAsB,CAClCA,EAAM,KAAK,YAAA,IAAkB,UAE7B,KAAK,SAAS,OAAO,aAAa,eAAe,GAAK,UAC1D,KAAK,UAAU,EACfA,EAAM,gBAAgB,EACjB,KAAA,SAAS,OAAO,QACtB,CAEA,YAAYA,EAAmB,CAC9BA,EAAM,eAAe,EACf,MAAAC,EAAO,KAAK,cAAc,MAAM,EACjC,KAAA,SAAS,MAAM,MACnBC,EAAsBF,CAAK,EAAE,QAAQ,OAAS,KAAK,SAAS,MAAM,MAC/DC,GAAMA,EAAK,OAAO,CACvB,CAEA,cAAe,CACT,KAAA,SAAS,OAAO,QAChB,KAAA,SAAS,MAAM,gBAAgB,QAAQ,EAC5C,KAAK,SAAS,OAAO,aACpB,iBACC,KAAK,SAAS,OAAO,aAAa,eAAe,IAAM,SAAS,SAAS,CAAA,CAE5E,CAEA,cAAcD,EAA+B,CACpC,MAAAG,EAAgBC,EAAsBJ,CAAK,EAC7CK,EACL,KAAK,SAAS,MAAM,SAASF,CAAa,GAC1C,KAAK,SAAS,OAAO,SAASA,CAAa,GACxC,CAACH,EAAM,eAAiB,CAACK,IAC5B,KAAK,UAAU,CAEjB,CACD,CA/DaT,EACL,aAAe,oBCFvBU,EAAkBV,CAAgB"}