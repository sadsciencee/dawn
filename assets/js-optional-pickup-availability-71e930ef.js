import{q as n,g as s,a,t as c,s as l}from"./functions-24c9f5aa.js";import{U as h}from"./UcoastEl-260a5367.js";import{r as y,t as m}from"./global-a82f9e0b.js";class d extends h{constructor(){if(super(),!this.hasAttribute("available"))return;const t=n("template",this).content,i=t.firstElementChild;(!t||!i||i===null)&&console.error("No template content found in PickupAvailability"),this.errorHtml=i==null?void 0:i.cloneNode(!0),this.onClickRefreshList=this.onClickRefreshList.bind(this);const r=s("variant-id",this);this.fetchAvailability(r)}fetchAvailability(e){let t=this.dataset.rootUrl;t||(t=window.location.origin),t.endsWith("/")||(t=t+"/");const i=`${t}variants/${e}/?section_id=pickup-availability`;fetch(i).then(r=>r.text()).then(r=>{const o=new DOMParser().parseFromString(r,"text/html").querySelector(".shopify-section");if(o instanceof Document)this.renderPreview(o);else throw new Error("No shopify-section found in sectionInnerHTML or was not instance of document")}).catch(r=>{console.error(r);const o=this.querySelector("button");o&&o.removeEventListener("click",this.onClickRefreshList),this.renderError()})}onClickRefreshList(e){const t=s("variant-id",this);this.fetchAvailability(t)}renderError(){if(this.innerHTML="",!this.errorHtml)throw new Error("renderError thrown too early");this.appendChild(this.errorHtml),n("button",this).addEventListener("click",this.onClickRefreshList)}renderPreview(e){const t=a("pickup-availability-drawer");t&&t.remove();const i=a("pickup-availability-preview",e);if(!i){this.innerHTML="",this.removeAttribute("available");return}this.innerHTML=i.outerHTML,this.setAttribute("available","");const r=e.querySelector("pickup-availability-drawer");if(r instanceof Node)document.body.appendChild(r);else throw new Error("No pickup-availability-drawer found in sectionInnerHTML");const o=this.querySelector("button");o&&o.addEventListener("click",v=>{const b=n("pickup-availability-drawer"),f=c(v);b.show(f)})}}d.htmlSelector="pickup-availability";class u extends h{constructor(){super(),this.onBodyClick=this.handleBodyClick.bind(this),this.opener=n("button",this),this.opener.addEventListener("click",()=>{this.hide()}),this.addEventListener("keyup",e=>{e.code.toUpperCase()==="ESCAPE"&&this.hide()})}handleBodyClick(e){const t=c(e);t!=this&&!t.closest("pickup-availability-drawer")&&t.id!="ShowPickupAvailabilityDrawer"&&this.hide()}hide(){this.removeAttribute("open"),document.body.removeEventListener("click",this.onBodyClick),document.body.classList.remove("overflow-hidden"),y(this.focusElement)}show(e){this.focusElement=e,this.setAttribute("open",""),document.body.addEventListener("click",this.onBodyClick),document.body.classList.add("overflow-hidden"),m(this)}}u.htmlSelector="pickup-availability-drawer";l(u);l(d);
//# sourceMappingURL=js-optional-pickup-availability-71e930ef.js.map
