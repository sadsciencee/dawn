{"version":3,"file":"js-optional-product-model-b9729c5a.js","sources":["../src/scripts/optional/product-model.ts","../src/entry/js-optional-product-model.ts"],"sourcesContent":["import { DeferredMedia } from '@/scripts/theme/deferred-media'\nimport { ModelViewerUIReference, uCoastWindow } from '@/scripts/setup'\nimport { qsaOptional, qsRequired } from '@/scripts/functions'\n\ndeclare let window: uCoastWindow\n\nexport class ProductModel extends DeferredMedia {\n\tstatic override htmlSelector = 'product-model'\n\tmodelViewerUI?: ModelViewerUIReference\n\tconstructor() {\n\t\tsuper()\n\t}\n\n\toverride loadContent() {\n\t\tsuper.loadContent()\n\n\t\tif (window.Shopify && window.Shopify.loadFeatures) {\n\t\t\twindow.Shopify.loadFeatures([\n\t\t\t\t{\n\t\t\t\t\tname: 'model-viewer-ui',\n\t\t\t\t\tversion: '1.0',\n\t\t\t\t\tonLoad: this.setupModelViewerUI.bind(this),\n\t\t\t\t},\n\t\t\t])\n\t\t}\n\t}\n\n\tsetupModelViewerUI(errors: unknown) {\n\t\tif (errors) return\n\n\t\tif (!window.Shopify || !window.Shopify.ModelViewerUI)\n\t\t\tthrow new Error('window.Shopify.ModelViewerUI is not defined')\n\t\tconst modelViewerEl = qsRequired('model-viewer', this)\n\n\t\tthis.modelViewerUI = new window.Shopify.ModelViewerUI(modelViewerEl)\n\t}\n}\n\nexport class WindowProductModel {\n\tloadShopifyXR() {\n\t\tif (!window.Shopify.loadFeatures)\n\t\t\tthrow new Error('window.Shopify.loadFeatures is not defined')\n\t\twindow.Shopify.loadFeatures([\n\t\t\t{\n\t\t\t\tname: 'shopify-xr',\n\t\t\t\tversion: '1.0',\n\t\t\t\tonLoad: this.setupShopifyXR.bind(this),\n\t\t\t},\n\t\t])\n\t}\n\tsetupShopifyXR(errors?: unknown) {\n\t\tif (errors) return\n\n\t\tif (!window.ShopifyXR) {\n\t\t\tdocument.addEventListener('shopify_xr_initialized', () => this.setupShopifyXR())\n\t\t\treturn\n\t\t}\n\n\t\tconst productJsonScripts = qsaOptional<HTMLScriptElement>('[id^=\"ProductJSON-\"]')\n\t\tif (productJsonScripts) {\n\t\t\tproductJsonScripts.forEach((modelJSON) => {\n\t\t\t\tif (!window.ShopifyXR) throw new Error('window.ShopifyXR is not defined')\n\t\t\t\tconst textContent = modelJSON.textContent\n\t\t\t\tif (!textContent) throw new Error('modelJSON.textContent is not defined')\n\t\t\t\twindow.ShopifyXR.addModels(JSON.parse(textContent))\n\t\t\t\tmodelJSON.remove()\n\t\t\t})\n\t\t}\n\t\twindow.ShopifyXR.setupXRElements()\n\t}\n}\n// this should run as a post-definition callback on the custom element\nexport function loadProductModel() {\n\twindow.ProductModel = new WindowProductModel()\n\n\twindow.addEventListener('DOMContentLoaded', () => {\n\t\tif (window.ProductModel && window.ProductModel instanceof WindowProductModel)\n\t\t\twindow.ProductModel.loadShopifyXR()\n\t})\n}\n","import { ProductModel } from '@/scripts/optional/product-model'\nimport { safeDefineElement } from '@/scripts/functions'\nsafeDefineElement(ProductModel)\n"],"names":["ProductModel","DeferredMedia","errors","modelViewerEl","qsRequired","safeDefineElement"],"mappings":"mIAMO,MAAMA,UAAqBC,CAAc,CAG/C,aAAc,CACP,OACP,CAES,aAAc,CACtB,MAAM,YAAY,EAEd,OAAO,SAAW,OAAO,QAAQ,cACpC,OAAO,QAAQ,aAAa,CAC3B,CACC,KAAM,kBACN,QAAS,MACT,OAAQ,KAAK,mBAAmB,KAAK,IAAI,CAC1C,CAAA,CACA,CAEH,CAEA,mBAAmBC,EAAiB,CAC/B,GAAAA,EAAQ,OAEZ,GAAI,CAAC,OAAO,SAAW,CAAC,OAAO,QAAQ,cAChC,MAAA,IAAI,MAAM,6CAA6C,EACxD,MAAAC,EAAgBC,EAAW,eAAgB,IAAI,EAErD,KAAK,cAAgB,IAAI,OAAO,QAAQ,cAAcD,CAAa,CACpE,CACD,CA9BaH,EACI,aAAe,gBCLhCK,EAAkBL,CAAY"}