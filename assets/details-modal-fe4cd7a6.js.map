{"version":3,"file":"details-modal-fe4cd7a6.js","sources":["../src/scripts/theme/details-modal.ts"],"sourcesContent":["import {\n\tclosestOptional,\n\tqsOptional,\n\tqsRequired,\n\ttargetClosestOptional,\n\ttargetRequired,\n} from '@/scripts/functions'\nimport { removeTrapFocus, trapFocus } from '@/scripts/theme/global'\nimport { UcoastEl } from '@/scripts/core/UcoastEl'\n\nexport class DetailsModal extends UcoastEl {\n\tstatic htmlSelector = 'details-modal'\n\tdetailsContainer: HTMLDetailsElement\n\tsummaryToggle: HTMLElement\n\tbutton: HTMLButtonElement\n\tonBodyClickEvent?: (event: MouseEvent) => undefined\n\tconstructor() {\n\t\tsuper()\n\t\tthis.detailsContainer = qsRequired('details', this)\n\t\tthis.summaryToggle = qsRequired('summary', this)\n\t\tthis.button = qsRequired('button[type=\"button\"]', this)\n\n\t\tthis.detailsContainer.addEventListener(\n\t\t\t'keyup',\n\t\t\t(event) => event.code.toUpperCase() === 'ESCAPE' && this.close()\n\t\t)\n\t\tthis.summaryToggle.addEventListener('click', this.onSummaryClick.bind(this))\n\t\tthis.button.addEventListener('click', this.close.bind(this))\n\n\t\tthis.summaryToggle.setAttribute('role', 'button')\n\t}\n\n\tisOpen() {\n\t\treturn this.detailsContainer.hasAttribute('open')\n\t}\n\n\tonSummaryClick(event: MouseEvent) {\n\t\tevent.preventDefault()\n\t\tconst closestDetails = targetClosestOptional(event, 'details')\n\t\tclosestDetails?.hasAttribute('open')\n\t\t\t? this.close()\n\t\t\t: this.open({\n\t\t\t\t\ttarget: targetRequired(event),\n\t\t\t  })\n\t}\n\n\tonBodyClick(event: MouseEvent) {\n\t\tconst target = targetRequired(event)\n\t\tif (!this.contains(target) || target.classList.contains('modal-overlay')) this.close(false)\n\t}\n\n\topen(event: { target: HTMLElement }) {\n\t\tthis.onBodyClickEvent = this.onBodyClickEvent || this.onBodyClick.bind(this)\n\t\tif (!this.onBodyClickEvent) throw new Error('onBodyClickEvent is undefined')\n\t\tconst closestDetails = closestOptional(event.target, 'details')\n\t\tif (closestDetails) {\n\t\t\tclosestDetails.setAttribute('open', 'true')\n\t\t}\n\n\t\tdocument.body.addEventListener('click', this.onBodyClickEvent)\n\t\tdocument.body.classList.add('overflow-hidden')\n\n\t\ttrapFocus(\n\t\t\tqsRequired('[tabindex=\"-1\"]', this.detailsContainer),\n\t\t\tqsOptional('input:not([type=\"hidden\"])', this.detailsContainer)\n\t\t)\n\t}\n\n\tclose(focusToggle = true) {\n\t\tremoveTrapFocus(focusToggle ? this.summaryToggle : undefined)\n\t\tthis.detailsContainer.removeAttribute('open')\n\t\tif (this.onBodyClickEvent) {\n\t\t\tdocument.body.removeEventListener('click', this.onBodyClickEvent)\n\t\t}\n\n\t\tdocument.body.classList.remove('overflow-hidden')\n\t}\n}\n\ncustomElements.define('details-modal', DetailsModal)\n"],"names":["DetailsModal","UcoastEl","qsRequired","event","closestDetails","targetClosestOptional","targetRequired","target","closestOptional","trapFocus","qsOptional","focusToggle","removeTrapFocus"],"mappings":"mKAUO,MAAMA,UAAqBC,CAAS,CAM1C,aAAc,CACP,QACD,KAAA,iBAAmBC,EAAW,UAAW,IAAI,EAC7C,KAAA,cAAgBA,EAAW,UAAW,IAAI,EAC1C,KAAA,OAASA,EAAW,wBAAyB,IAAI,EAEtD,KAAK,iBAAiB,iBACrB,QACCC,GAAUA,EAAM,KAAK,gBAAkB,UAAY,KAAK,MAAM,CAAA,EAEhE,KAAK,cAAc,iBAAiB,QAAS,KAAK,eAAe,KAAK,IAAI,CAAC,EAC3E,KAAK,OAAO,iBAAiB,QAAS,KAAK,MAAM,KAAK,IAAI,CAAC,EAEtD,KAAA,cAAc,aAAa,OAAQ,QAAQ,CACjD,CAEA,QAAS,CACD,OAAA,KAAK,iBAAiB,aAAa,MAAM,CACjD,CAEA,eAAeA,EAAmB,CACjCA,EAAM,eAAe,EACf,MAAAC,EAAiBC,EAAsBF,EAAO,SAAS,EAC7DC,GAAA,MAAAA,EAAgB,aAAa,QAC1B,KAAK,MAAM,EACX,KAAK,KAAK,CACV,OAAQE,EAAeH,CAAK,CAAA,CAC3B,CACL,CAEA,YAAYA,EAAmB,CACxB,MAAAI,EAASD,EAAeH,CAAK,GAC/B,CAAC,KAAK,SAASI,CAAM,GAAKA,EAAO,UAAU,SAAS,eAAe,IAAG,KAAK,MAAM,EAAK,CAC3F,CAEA,KAAKJ,EAAgC,CAEpC,GADA,KAAK,iBAAmB,KAAK,kBAAoB,KAAK,YAAY,KAAK,IAAI,EACvE,CAAC,KAAK,iBAAwB,MAAA,IAAI,MAAM,+BAA+B,EAC3E,MAAMC,EAAiBI,EAAgBL,EAAM,OAAQ,SAAS,EAC1DC,GACYA,EAAA,aAAa,OAAQ,MAAM,EAG3C,SAAS,KAAK,iBAAiB,QAAS,KAAK,gBAAgB,EACpD,SAAA,KAAK,UAAU,IAAI,iBAAiB,EAE7CK,EACCP,EAAW,kBAAmB,KAAK,gBAAgB,EACnDQ,EAAW,6BAA8B,KAAK,gBAAgB,CAAA,CAEhE,CAEA,MAAMC,EAAc,GAAM,CACTC,EAAAD,EAAc,KAAK,cAAgB,MAAS,EACvD,KAAA,iBAAiB,gBAAgB,MAAM,EACxC,KAAK,kBACR,SAAS,KAAK,oBAAoB,QAAS,KAAK,gBAAgB,EAGxD,SAAA,KAAK,UAAU,OAAO,iBAAiB,CACjD,CACD,CAnEaX,EACL,aAAe,gBAoEvB,eAAe,OAAO,gBAAiBA,CAAY"}