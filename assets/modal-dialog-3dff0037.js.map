{"version":3,"file":"modal-dialog-3dff0037.js","sources":["../src/scripts/theme/modal-dialog.ts"],"sourcesContent":["import { pauseAllMedia, qsOptional, qsRequired, targetClosestOptional } from '@/scripts/functions'\nimport { type DeferredMedia } from '@/scripts/theme/deferred-media'\nimport { removeTrapFocus, trapFocus } from '@/scripts/theme/global'\nimport { UcoastEl } from '@/scripts/core/UcoastEl'\n\nexport class ModalDialog extends UcoastEl {\n\tstatic htmlSelector = 'modal-dialog'\n\tmoved: boolean = false\n\topenedBy?: HTMLElement\n\tconstructor() {\n\t\tsuper()\n\t\tthis.querySelector('[id^=\"ModalClose-\"]')?.addEventListener(\n\t\t\t'click',\n\t\t\tthis.hide.bind(this, false)\n\t\t)\n\t\tthis.addEventListener('keyup', (event) => {\n\t\t\tif (event.code.toUpperCase() === 'ESCAPE') this.hide()\n\t\t})\n\t\tif (this.classList.contains('media-modal')) {\n\t\t\tthis.addEventListener('pointerup', (event) => {\n\t\t\t\tif (\n\t\t\t\t\tevent.pointerType === 'mouse' &&\n\t\t\t\t\t!targetClosestOptional(event, 'deferred-media, product-model')\n\t\t\t\t)\n\t\t\t\t\tthis.hide()\n\t\t\t})\n\t\t} else {\n\t\t\tthis.addEventListener('click', (event) => {\n\t\t\t\tif (event.target === this) this.hide()\n\t\t\t})\n\t\t}\n\t}\n\n\toverride connectedCallback() {\n\t\tif (this.moved) return\n\t\tthis.moved = true\n\t\tdocument.body.appendChild(this)\n\t}\n\n\tshow(opener: HTMLElement) {\n\t\tthis.openedBy = opener\n\t\tconst popup = qsOptional<DeferredMedia>('.template-popup', this)\n\t\tdocument.body.classList.add('overflow-hidden')\n\t\tthis.setAttribute('open', '')\n\t\tif (popup) popup.loadContent()\n\t\ttrapFocus(this, qsRequired('[role=\"dialog\"]', this))\n\t\tpauseAllMedia()\n\t}\n\n\thide() {\n\t\tdocument.body.classList.remove('overflow-hidden')\n\t\tdocument.body.dispatchEvent(new CustomEvent('modalClosed'))\n\t\tthis.removeAttribute('open')\n\t\tremoveTrapFocus(this.openedBy)\n\t\tpauseAllMedia()\n\t}\n}\n"],"names":["ModalDialog","UcoastEl","_a","event","targetClosestOptional","opener","popup","qsOptional","trapFocus","qsRequired","pauseAllMedia","removeTrapFocus"],"mappings":"uJAKO,MAAMA,UAAoBC,CAAS,CAIzC,aAAc,OACP,QAHU,KAAA,MAAA,IAIXC,EAAA,KAAA,cAAc,qBAAqB,IAAnC,MAAAA,EAAsC,iBAC1C,QACA,KAAK,KAAK,KAAK,KAAM,EAAK,GAEtB,KAAA,iBAAiB,QAAUC,GAAU,CACrCA,EAAM,KAAK,YAAA,IAAkB,UAAU,KAAK,KAAK,CAAA,CACrD,EACG,KAAK,UAAU,SAAS,aAAa,EACnC,KAAA,iBAAiB,YAAcA,GAAU,CAE5CA,EAAM,cAAgB,SACtB,CAACC,EAAsBD,EAAO,+BAA+B,GAE7D,KAAK,KAAK,CAAA,CACX,EAEI,KAAA,iBAAiB,QAAUA,GAAU,CACrCA,EAAM,SAAW,MAAM,KAAK,KAAK,CAAA,CACrC,CAEH,CAES,mBAAoB,CACxB,KAAK,QACT,KAAK,MAAQ,GACJ,SAAA,KAAK,YAAY,IAAI,EAC/B,CAEA,KAAKE,EAAqB,CACzB,KAAK,SAAWA,EACV,MAAAC,EAAQC,EAA0B,kBAAmB,IAAI,EACtD,SAAA,KAAK,UAAU,IAAI,iBAAiB,EACxC,KAAA,aAAa,OAAQ,EAAE,EACxBD,GAAOA,EAAM,YAAY,EAC7BE,EAAU,KAAMC,EAAW,kBAAmB,IAAI,CAAC,EACrCC,GACf,CAEA,MAAO,CACG,SAAA,KAAK,UAAU,OAAO,iBAAiB,EAChD,SAAS,KAAK,cAAc,IAAI,YAAY,aAAa,CAAC,EAC1D,KAAK,gBAAgB,MAAM,EAC3BC,EAAgB,KAAK,QAAQ,EACfD,GACf,CACD,CAnDaV,EACL,aAAe"}