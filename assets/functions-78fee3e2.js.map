{"version":3,"file":"functions-78fee3e2.js","sources":["../src/scripts/functions.ts"],"sourcesContent":["// in general, these functions are for enforcing types when access HTML dom elements so I don't have to think about it so much\n// right now I've avoided any other helper functions but if we get another sub category of functions we should change this to a folder 'functions'\n\n// TODO: add KlaviyoPopup back in\n//import { type KlaviyoPopup, type Modal, type NotifyMe } from '@/scripts/content/modal'\n//import { type QuickAddModal } from '@/scripts/optional/quick-add'\nimport {\n\tDebounceCallback,\n\tEventWithRelatedTarget,\n\tFocusableHTMLElement,\n} from '@/scripts/types/theme'\nimport { ProductModel } from '@/scripts/optional/product-model'\n\n// local types\n\ntype HTMLElementProperty =\n\t| 'parentNode'\n\t| 'firstChild'\n\t| 'lastChild'\n\t| 'previousSibling'\n\t| 'nextSibling'\n\t| 'firstElementChild'\n\t| 'lastElementChild'\n\t| 'previousElementSibling'\n\t| 'nextElementSibling'\n\t| 'parentElement'\n\ntype CommonEventType = MouseEvent | KeyboardEvent | TouchEvent\n\n// begin typescript DOM functions\n// this is a set of functions I wrote while refactoring Dawn 9.0 to typescript\n// ended up being very flexible and useful for enforcing types when accessing dom elements so we are reusing for Dawn 10.0\n\nexport const qsRequired = <T extends HTMLElement = HTMLElement, U extends HTMLElement = T>(\n\tselector: string,\n\tcomponent?: HTMLElement,\n\tadditionalProperty?: HTMLElementProperty\n) => {\n\tconst container = component ?? document\n\tconst element = container.querySelector(selector) as T | null\n\tif (!element) throw new Error(`required element not found: ${selector}`)\n\tif (!additionalProperty) return element\n\tconst elFromProperty = element[additionalProperty] as U | null\n\tif (!elFromProperty) throw new Error(`required element not found: ${selector}`)\n\treturn elFromProperty\n}\n\nexport const qsRequiredFromDocument = <T extends HTMLElement = HTMLElement>(\n\tselector: string,\n\tparsedDocument: Document\n) => {\n\tconst element = parsedDocument.querySelector(selector) as T | null\n\tif (!element) throw `required element not found: ${selector}`\n\treturn element\n}\n\n// required querySelectorAll\nexport const qsaRequired = <T extends HTMLElement = HTMLElement>(\n\tselector: string,\n\tcomponent?: HTMLElement | Document\n) => {\n\tconst container = component ?? document\n\tconst elements = container.querySelectorAll(selector) as NodeListOf<T>\n\tif (!elements.length) throw new Error(`required element group not found: ${selector}`)\n\treturn elements\n}\n\n// return undefined if the HTML element isn't found\nexport const qsOptional = <T extends HTMLElement = HTMLElement>(\n\tselector: string,\n\tcomponent?: HTMLElement | Document\n) => {\n\tconst container = component ?? document\n\tconst element = container.querySelector(selector) as T | null\n\treturn element ?? undefined\n}\n\n// optional querySelectorAll typecast\nexport const qsaOptional = <T extends HTMLElement = HTMLElement>(\n\tselector: string,\n\tcomponent?: HTMLElement | Document\n) => {\n\tconst container = component ?? document\n\tconst elements = container.querySelectorAll(selector) as NodeListOf<T>\n\tif (!elements.length) return undefined\n\treturn elements\n}\n\n// required event targets\nexport const currentTargetRequired = <\n\tE extends Event = CommonEventType,\n\tT extends HTMLElement = HTMLElement\n>(\n\tevent: E\n) => {\n\tconst element = event.currentTarget as (EventTarget & T) | null\n\tif (!element) throw new Error(`required element not found: event.currentTarget`)\n\treturn element\n}\n\nexport const relatedTargetRequired = <\n\tE extends EventWithRelatedTarget = EventWithRelatedTarget,\n\tT extends HTMLElement = HTMLElement\n>(\n\tevent: E\n) => {\n\tconst element = event.relatedTarget as (EventTarget & T) | null\n\tif (!element) throw new Error(`required element not found: event.currentTarget`)\n\treturn element\n}\n\nexport const relatedTargetOptional = <\n\tE extends EventWithRelatedTarget = EventWithRelatedTarget,\n\tT extends HTMLElement = HTMLElement\n>(\n\tevent: E\n) => {\n\treturn (event.relatedTarget as EventTarget & T) ?? undefined\n}\n\nexport const targetRequired = <\n\tE extends Event = CommonEventType,\n\tT extends HTMLElement | Document = HTMLElement\n>(\n\tevent: E\n) => {\n\tconst element = event.target as T | null\n\tif (!element) throw new Error(`required element not found: event.currentTarget`)\n\treturn element\n}\n\n// optional event targets. this is sort of not important but will probably make type casting easier\nexport const currentTargetOptional = <\n\tE extends Event = CommonEventType,\n\tT extends HTMLElement = HTMLElement\n>(\n\tevent: E\n) => {\n\treturn (event.currentTarget as EventTarget & T) ?? undefined\n}\n\nexport const targetOptional = <\n\tE extends Event = CommonEventType,\n\tT extends HTMLElement = HTMLElement\n>(\n\tevent: E\n) => {\n\treturn (event.target as EventTarget & T) ?? undefined\n}\n\nexport const targetClosestRequired = <\n\tE extends Event = CommonEventType,\n\tT extends HTMLElement = HTMLElement\n>(\n\tevent: E,\n\tselector: string\n) => {\n\tconst element = event.target as T | null\n\tif (!element) throw new Error(`required element not found: event.currentTarget`)\n\tconst closest = element.closest(selector) as T\n\tif (!closest)\n\t\tthrow new Error(`required element not found: ${element.nodeName}.closest(${selector})`)\n\treturn closest\n}\n\nexport const targetClosestOptional = <\n\tE extends Event = CommonEventType,\n\tT extends HTMLElement = HTMLElement\n>(\n\tevent: E,\n\tselector: string\n) => {\n\tconst element = event.target as T | null\n\tif (!element) return undefined\n\tconst closest = element.closest(selector) as T\n\tif (!closest) return undefined\n\treturn closest\n}\n\n// properties and methods of HTML elements that return an HTMLElement\nexport const closestRequired = <T extends HTMLElement = HTMLElement>(\n\telement: HTMLElement,\n\tselector: string\n) => {\n\tconst closest = element.closest(selector) as T\n\tif (!closest)\n\t\tthrow new Error(`required element not found: ${element.nodeName}.closest(${selector})`)\n\treturn closest\n}\n\nexport const closestOptional = <T extends HTMLElement = HTMLElement>(\n\telement: HTMLElement,\n\tselector: string\n) => {\n\treturn (element.closest(selector) as T) ?? undefined\n}\n\nexport const elementPropertyRequired = <T extends HTMLElement = HTMLElement>(\n\telement: HTMLElement,\n\tproperty: HTMLElementProperty\n) => {\n\tconst parent = element[property] as T | null\n\tif (!parent) throw new Error(`required element not found: ${element.nodeName}.parentNode`)\n\treturn parent\n}\n\n// this function is use to safely define a new custom element\n// it allows callbacks to be run before and after the element is defined -\n// callback functionality is mainly for shop filters but can apply to any class with heavy usage of static methods\n\ninterface CustomElementConstructorWithStaticTagName extends CustomElementConstructor {\n\thtmlSelector: string\n}\n\n// throw error if something goes wrong with a constructor\nexport const safeDefineElement = (\n\telementClass: CustomElementConstructorWithStaticTagName,\n\tcallbackBefore?: Function,\n\tcallbackAfter?: Function\n): void => {\n\ttry {\n\t\tif (customElements.get(elementClass.htmlSelector)) return\n\t\tif (callbackBefore instanceof Function) {\n\t\t\tconst elsInDocument = qsaOptional(elementClass.htmlSelector)\n\t\t\tif (elsInDocument) {\n\t\t\t\tcallbackBefore()\n\t\t\t}\n\t\t}\n\t\tcustomElements.define(elementClass.htmlSelector, elementClass)\n\t\tif (callbackAfter instanceof Function) {\n\t\t\tconst elsInDocument = qsaOptional(elementClass.htmlSelector)\n\t\t\tif (elsInDocument) {\n\t\t\t\tcallbackAfter()\n\t\t\t}\n\t\t}\n\t} catch (error) {\n\t\tconsole.error(\n\t\t\t`Failed to define custom element '${elementClass.htmlSelector}': ${error.message}`\n\t\t)\n\t}\n}\n\n// formData helpers\nexport const getOrThrow = <T extends FormData | Map<any, any> = FormData>(data: T, key: string) => {\n\tconst value = data.get(key)\n\tif (!value) throw new Error(`Value ${key} not found in ${data}`)\n\treturn value\n}\nexport const getOrUndefined = <T extends FormData | Map<any, any> = FormData>(\n\tdata: T,\n\tkey: string\n) => {\n\tconst value = data.get(key)\n\tif (!value) return undefined\n\treturn value\n}\n\n// get attribute from element or throw error\nexport const getAttributeOrThrow = (attribute: string, el: HTMLElement) => {\n\tconst data = el.getAttribute(attribute)\n\tif (!data) throw new Error(`Attribute ${attribute} no found on element ${el}`)\n\treturn data\n}\n// browser safe replace all\nexport const replaceAll = (str: string, find: string, replace: string) => {\n\treturn str.split(find).join(replace)\n}\n\n// toggle attributes specific to ucoast builds, not used in default dawn repack\nexport const toggleActive = (el: HTMLElement, active: boolean) => {\n\tif (active) {\n\t\tel.setAttribute('data-uc-active', '')\n\t} else {\n\t\tel.removeAttribute('data-uc-active')\n\t}\n}\n\nexport const toggleIsEmpty = (el: HTMLElement, isEmpty: boolean) => {\n\tif (isEmpty) {\n\t\tel.setAttribute('data-uc-is-empty', '')\n\t} else {\n\t\tel.removeAttribute('data-uc-is-empty')\n\t}\n}\n\nexport const toggleLoading = (el: HTMLElement, loading: boolean) => {\n\tif (loading) {\n\t\tel.setAttribute('data-uc-loading', '')\n\t} else {\n\t\tel.removeAttribute('data-uc-loading')\n\t}\n}\n\n// scroll to anchor link with some ucoast-specific features, not used in default dawn repack\nexport const scrollToAnchor = (selector: string) => {\n\tconst header = qsRequired('[data-uc-header-wrapper]')\n\tconst anchor = qsRequired(selector)\n\tconst headerHeight = header.offsetHeight\n\tconst collectionTop = anchor.getBoundingClientRect().top\n\tconst scrollToPosition =\n\t\tcollectionTop -\n\t\theaderHeight -\n\t\tparseFloat(window?.getComputedStyle(anchor)?.getPropertyValue('margin-top') ?? 0) +\n\t\t1\n\twindow.scrollBy({ top: scrollToPosition, behavior: 'smooth' })\n}\n\n// TODO: refactor to use app proxy for security\nexport const getBackendRoute = () => {\n\treturn 'http://localhost:5000'\n}\n\nexport const getCurrentHeaderHeight = () => {\n\tlet height = 0\n\tconst headerSections = qsaRequired('.shopify-section-group-header-group')\n\theaderSections.forEach((section) => {\n\t\tconst sectionHeight = section.getBoundingClientRect().height\n\t\theight += sectionHeight\n\t})\n\treturn height\n}\n\n/*export const closeAllModals = () => {\n\tconst modals = qsaOptional<Modal | KlaviyoPopup | NotifyMe | QuickAddModal>(\n\t\t'modal-dialog, klaviyo-popup, notify-me, quick-add-modal'\n\t)\n\tif (!modals) return\n\tmodals.forEach((modal) => {\n\t\tif (typeof modal.hide === 'function' && modal.hasAttribute('open')) {\n\t\t\tmodal.hide()\n\t\t}\n\t})\n}*/\n\n// these three functions are somewhat similar - should be refactored for clarity\nexport const isElementInViewport = (el: HTMLElement) => {\n\tconst rect = el.getBoundingClientRect()\n\tconst result =\n\t\trect.top >= 0 &&\n\t\trect.left >= 0 &&\n\t\trect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&\n\t\trect.right <= (window.innerWidth || document.documentElement.clientWidth)\n\treturn result\n}\n\nexport const isInViewport = (element: HTMLElement) => {\n\tconst rect = element.getBoundingClientRect()\n\treturn (\n\t\trect.top < (window.innerHeight || document.documentElement.clientHeight) &&\n\t\trect.left < (window.innerWidth || document.documentElement.clientWidth) &&\n\t\trect.bottom > 0 &&\n\t\trect.right > 0\n\t)\n}\n\nexport const isTenPercentInViewport = (element: HTMLElement) => {\n\tconst rect = element.getBoundingClientRect()\n\tconst viewportHeight = window.innerHeight || document.documentElement.clientHeight\n\tconst viewportWidth = window.innerWidth || document.documentElement.clientWidth\n\n\tconst elementHeight = rect.height\n\tconst elementWidth = rect.width\n\n\tconst visibleHeight = Math.min(rect.bottom, viewportHeight) - Math.max(rect.top, 0)\n\tconst visibleWidth = Math.min(rect.right, viewportWidth) - Math.max(rect.left, 0)\n\n\tconst visibleArea = Math.max(0, visibleHeight) * Math.max(0, visibleWidth)\n\tconst elementArea = elementHeight * elementWidth\n\n\treturn visibleArea >= 0.1 * elementArea\n}\n\n// this function applies the scaling from the --ax variables. it is project-dependent\n// 1440 and 375 are specific to the size I request from designers, however should be refactored as Constants\n// TODO: add const defs for hard coded scaling values\n\nexport const scaleValue = (val: number, viewport: 'mobile' | 'desktop') => {\n\tlet ratio = viewport === 'desktop' ? 1440 / window.innerWidth : 375 / window.innerWidth\n\tif (viewport === 'desktop' && ratio > 1.25) ratio = 1.25 // this is a reverse of the 1:.8 ratio from desktop min in css\n\tif (viewport === 'desktop' && ratio < 1) ratio = 1 // this is a verse of the 1:1.15 ratio from desktop max in css\n\tif (viewport === 'mobile' && ratio > 1.1111111111) ratio = 1.1111111111\n\tif (viewport === 'mobile' && ratio < 1) ratio = 1\n\treturn (val * ratio).toFixed(1)\n}\n\n// TODO: refactor for default dawn repack\n// this sets all relevant height variables for the app\n\nexport const setHeightVars = (header: HTMLElement, announcement: HTMLElement | undefined) => {\n\tconst viewport = window.innerWidth >= 990 ? 'desktop' : 'mobile'\n\tconst viewportHeight =\n\t\tviewport === 'desktop'\n\t\t\t? '100vh'\n\t\t\t: `calc(${scaleValue(window.innerHeight, viewport)} * var(--ax))`\n\tdocument.documentElement.style.setProperty('--viewport-height', viewportHeight)\n\tdocument.documentElement.style.setProperty(\n\t\t'--header-height',\n\t\t`calc(${scaleValue(header.getBoundingClientRect().height, viewport)} * var(--ax))`\n\t)\n\n\tif (announcement) {\n\t\tdocument.documentElement.style.setProperty(\n\t\t\t'--announcement-height',\n\t\t\t`calc(${scaleValue(announcement.getBoundingClientRect().height, viewport)} * var(--ax))`\n\t\t)\n\t}\n}\n\n// set drawer height when opened - this prevents the drawer from being too short on mobile\n// tbh, shouldn't be necessary with proper height vars, but keeping it here since shopify uses it\nexport const setDrawerHeight = () => {\n\tdocument.documentElement.style.setProperty('--drawer-height', `${window.innerHeight}px`)\n}\n\n// accessibility functions\n\nexport function initializeSummaryA11y() {\n\t// this is from shopify\n\t// it adds some accessibility features to summary elements\n\tdocument.querySelectorAll('[id^=\"Details-\"] summary').forEach((summary) => {\n\t\tsummary.setAttribute('role', 'button')\n\t\tconst parentNode =\n\t\t\tsummary.parentNode instanceof HTMLElement ? summary.parentNode : undefined\n\t\tconst ariaExpandedVal = parentNode && parentNode.hasAttribute('open') ? 'true' : 'false'\n\t\tsummary.setAttribute('aria-expanded', ariaExpandedVal)\n\n\t\tconst nextElementSibling =\n\t\t\tsummary.nextElementSibling instanceof HTMLElement\n\t\t\t\t? summary.nextElementSibling\n\t\t\t\t: undefined\n\n\t\tif (nextElementSibling && nextElementSibling.hasAttribute('id')) {\n\t\t\tsummary.setAttribute('aria-controls', getAttributeOrThrow('id', nextElementSibling))\n\t\t}\n\n\t\tsummary.addEventListener('click', (event) => {\n\t\t\tconst currentTarget = currentTargetRequired(event)\n\t\t\tconst closestTarget = targetClosestRequired(event, 'details')\n\t\t\tcurrentTarget.setAttribute('aria-expanded', `${!closestTarget.hasAttribute('open')}`)\n\t\t})\n\n\t\tif (summary.closest('header-drawer, menu-drawer')) return\n\t\tconst parentElement =\n\t\t\tsummary.parentElement instanceof HTMLElement ? summary.parentElement : undefined\n\t\tif (!parentElement) return\n\t\tparentElement.addEventListener('keyup', onKeyUpEscape)\n\t})\n}\n\nexport function getFocusableElements(container: HTMLElement): FocusableHTMLElement[] {\n\treturn Array.from(\n\t\tcontainer.querySelectorAll(\n\t\t\t\"summary, a[href], button:enabled, [tabindex]:not([tabindex^='-']), [draggable], area, input:not([type=hidden]):enabled, select:enabled, textarea:enabled, object, iframe\"\n\t\t)\n\t)\n}\n\nexport function focusVisiblePolyfill() {\n\tconst navKeys = [\n\t\t'ARROWUP',\n\t\t'ARROWDOWN',\n\t\t'ARROWLEFT',\n\t\t'ARROWRIGHT',\n\t\t'TAB',\n\t\t'ENTER',\n\t\t'SPACE',\n\t\t'ESCAPE',\n\t\t'HOME',\n\t\t'END',\n\t\t'PAGEUP',\n\t\t'PAGEDOWN',\n\t]\n\tlet currentFocusedElement: HTMLElement | Element | null = null\n\tlet mouseClick: boolean | null = null\n\n\twindow.addEventListener('keydown', (event) => {\n\t\tif (navKeys.includes(event.code.toUpperCase())) {\n\t\t\tmouseClick = false\n\t\t}\n\t})\n\n\twindow.addEventListener('mousedown', (_event: MouseEvent) => {\n\t\tmouseClick = true\n\t})\n\n\twindow.addEventListener(\n\t\t'focus',\n\t\t() => {\n\t\t\tif (currentFocusedElement) currentFocusedElement.classList.remove('focused')\n\n\t\t\tif (mouseClick) return\n\n\t\t\tcurrentFocusedElement = document.activeElement\n\t\t\tif (currentFocusedElement instanceof HTMLElement) {\n\t\t\t\tcurrentFocusedElement.classList.add('focused')\n\t\t\t}\n\t\t},\n\t\ttrue\n\t)\n}\n\nexport function onKeyUpEscape(event: KeyboardEvent) {\n\tif (event.code.toUpperCase() !== 'ESCAPE') return\n\n\tconst openDetailsElement = targetClosestOptional(event, 'details[open]')\n\tif (!openDetailsElement) return\n\n\tconst summaryElement = qsRequired('summary', openDetailsElement)\n\topenDetailsElement.removeAttribute('open')\n\tsummaryElement.setAttribute('aria-expanded', 'false')\n\tsummaryElement.focus()\n}\n\nexport function pauseAllMedia() {\n\tconst jsYoutubeEls = qsaOptional<HTMLIFrameElement>('.js-youtube')\n\tif (jsYoutubeEls) {\n\t\tjsYoutubeEls.forEach((video) => {\n\t\t\tif (!video.contentWindow) return\n\t\t\tvideo.contentWindow.postMessage(\n\t\t\t\t'{\"event\":\"command\",\"func\":\"' + 'pauseVideo' + '\",\"args\":\"\"}',\n\t\t\t\t'*'\n\t\t\t)\n\t\t})\n\t}\n\n\tconst jsVimeoEls = qsaOptional<HTMLIFrameElement>('.js-vimeo')\n\tif (jsVimeoEls) {\n\t\tjsVimeoEls.forEach((video) => {\n\t\t\tif (!video.contentWindow) return\n\t\t\tvideo.contentWindow.postMessage('{\"method\":\"pause\"}', '*')\n\t\t})\n\t}\n\n\tconst html5Videos = qsaOptional<HTMLVideoElement>('video')\n\tif (html5Videos) {\n\t\thtml5Videos.forEach((video) => video.pause())\n\t}\n\n\tconst productModels = qsaOptional<ProductModel>('product-model')\n\tif (productModels) {\n\t\tproductModels.forEach((model) => {\n\t\t\tif (model.modelViewerUI) model.modelViewerUI.pause()\n\t\t})\n\t}\n}\n\n// event based functions\n\nexport function debounce(fn: Function, wait: number): DebounceCallback {\n\tlet timeoutId: number\n\treturn (...args) => {\n\t\tclearTimeout(timeoutId)\n\t\t// @ts-ignore\n\t\t// since this is a generic function that can literally be used for anything, I think 'any' is the best type here\n\t\t// 'unknown' would be better but we can't assign a type without moving off of arrow functions\n\t\ttimeoutId = setTimeout(() => fn.apply(this, args), wait)\n\t}\n}\nexport function throttle(fn: Function, delay: number = 0) {\n\tlet lastCall = 0\n\treturn function (...args: unknown[]) {\n\t\tconst now = new Date().getTime()\n\t\tif (now - lastCall < delay) {\n\t\t\treturn\n\t\t}\n\t\tlastCall = now\n\t\treturn fn(...args)\n\t}\n}\n\n// fetch API configs\n\nexport function fetchConfig(type = 'json') {\n\treturn {\n\t\tmethod: 'POST',\n\t\theaders: { 'Content-Type': 'application/json', Accept: `application/${type}` },\n\t}\n}\n\ntype AddToCartFormValues = {\n\titems: { quantity: number; id: number }[]\n\tform_type: string\n\tsections?: string\n\tsections_url?: string\n}\n\nexport function addToCartConfig(body: FormData) {\n\tconst quantity = getOrUndefined(body, 'quantity') ? parseInt(getOrThrow(body, 'quantity')) : 1\n\tconst data: AddToCartFormValues = {\n\t\titems: [\n\t\t\t{\n\t\t\t\tquantity,\n\t\t\t\tid: parseInt(getOrThrow(body, 'id')),\n\t\t\t},\n\t\t],\n\t\tform_type: getOrThrow(body, 'form_type'),\n\t\tsections: getOrUndefined(body, 'sections'),\n\t\tsections_url: getOrUndefined(body, 'sections_url'),\n\t}\n\treturn {\n\t\tmethod: 'POST',\n\t\theaders: {\n\t\t\t'Content-Type': 'application/json',\n\t\t\tAccept: `application/json`,\n\t\t\t'X-Requested-With': 'XMLHttpRequest',\n\t\t},\n\t\tbody: JSON.stringify(data),\n\t}\n}\n\n// klaviyo & notify me not part of initial dawn but will be in every project\n\ntype AddToKlaviyoListFormValues = {\n\temail: string\n\tlist_id: string\n\tphone_number?: string\n}\n\nexport function addToKlaviyoListConfig(body: FormData) {\n\tconst data: AddToKlaviyoListFormValues = {\n\t\temail: getOrThrow(body, 'email'),\n\t\tlist_id: getOrThrow(body, 'list_id'),\n\t\tphone_number: getOrUndefined(body, 'phone_number'),\n\t}\n\treturn {\n\t\tmethod: 'POST',\n\t\tmode: 'cors' as RequestMode,\n\t\theaders: {\n\t\t\t'Content-Type': 'application/json',\n\t\t},\n\t\tbody: JSON.stringify(data),\n\t}\n}\n\ntype NotifyMeConfigValues = {\n\temail: string\n\tvariant: string\n}\n\nexport function notifyMeConfig(body: FormData) {\n\tconst data: NotifyMeConfigValues = {\n\t\temail: getOrThrow(body, 'email'),\n\t\tvariant: getOrThrow(body, 'variant'),\n\t}\n\treturn {\n\t\tmethod: 'POST',\n\t\tmode: 'cors' as RequestMode,\n\t\theaders: {\n\t\t\t'Content-Type': 'application/json',\n\t\t},\n\t\tbody: JSON.stringify(data),\n\t}\n}\n\n// recentlyViewedProducts isn't part of dawn, but it's in my 9.0 build pack so leaving here for now\n\nexport function getRecentlyViewedProducts(): string[] {\n\tconst pageList = localStorage.getItem('pageList')\n\tif (!pageList) return []\n\treturn JSON.parse(pageList) || []\n}\n\nexport function trackRecentlyViewedProducts() {\n\tconst pageList = getRecentlyViewedProducts()\n\n\tlet currentUrl = window.location.href.split('?')[0]\n\n\tif (!pageList.includes(currentUrl) && currentUrl.includes('/products/')) {\n\t\tpageList.push(currentUrl)\n\n\t\tif (pageList.length > 4) {\n\t\t\tpageList.shift()\n\t\t}\n\n\t\tlocalStorage.setItem('pageList', JSON.stringify(pageList))\n\t}\n}\n"],"names":["qsRequired","selector","component","additionalProperty","element","elFromProperty","qsaRequired","elements","qsOptional","qsaOptional","currentTargetRequired","event","relatedTargetOptional","targetRequired","currentTargetOptional","targetClosestRequired","closest","targetClosestOptional","closestRequired","closestOptional","safeDefineElement","elementClass","callbackBefore","callbackAfter","error","getOrThrow","data","key","value","getOrUndefined","getAttributeOrThrow","attribute","el","replaceAll","str","find","replace","initializeSummaryA11y","summary","parentNode","ariaExpandedVal","nextElementSibling","currentTarget","closestTarget","parentElement","onKeyUpEscape","getFocusableElements","container","focusVisiblePolyfill","navKeys","currentFocusedElement","mouseClick","_event","openDetailsElement","summaryElement","pauseAllMedia","jsYoutubeEls","video","jsVimeoEls","html5Videos","productModels","model","debounce","fn","wait","timeoutId","args","throttle","delay","lastCall","now","fetchConfig","type","addToCartConfig","body"],"mappings":"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"}