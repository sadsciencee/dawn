{% comment %}
  file: feeds into 'ucoast' param in the vite plugin
  settings [bool]:
    preload_stylesheet: if true, will preload the stylesheet
    ignore_s_up: disable s_up breakpoint for this file
    ignore_m_up: all css that isn't required for small screens
{% endcomment %}

{% liquid
    assign base_file = file | append: '.scss'
    assign s_up_file = file | append: '.s-up.scss'
    capture base_url
        render 'ucoast', ucoast: base_file
    endcapture
    assign base_url = base_url | strip

    if preload_stylesheet == true
        echo base_url | stylesheet_tag: preload: true
        unless ignore_s_up
            capture s_up_url
                render 'ucoast', ucoast: s_up_file
            endcapture
            assign s_up_url = s_up_url | strip
            echo s_up_url | stylesheet_tag: preload: true, media: '(min-width: 750px)'
        endunless
    else
        render 'ucoast-defer-style', url: base_url
        unless ignore_s_up
            capture s_up_url
                render 'ucoast', ucoast: s_up_file
            endcapture
            assign s_up_url = s_up_url | strip
            render 'ucoast-defer-style', url: base_url, media: '(min-width: 750px)'
        endunless
    endif
%}
