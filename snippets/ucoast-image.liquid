{% comment %}
	this should only be called from ucoast-media
{% endcomment %}
<span
	class="{{ wrapper_class }} media media--transparent"

	{% if aspect_ratio == 'auto' and image != blank %}
		style="--media-ratio: {{ 1 | divided_by: image.aspect_ratio }};"
	{% elsif aspect_ratio == 'auto' %}
		style="--media-ratio: 1;"
	{% endif %}
>
	{% liquid
		if media_child
			echo media_child
		endif
		capture input
			echo image | image_url: width: starting_width | image_tag: loading: loading, class: image_class, id: id, style: style, preload: preload, alt: alt
		endcapture
		assign starting_src = image | image_url: width: starting_width
		assign replace_src = ' src="' | append: starting_src | append: '" data-src='
		if defer
			assign replace_src = ' data-uc-defer ' | append: replace_src
		endif
		if multiplier != 1
			assign replace_src = ' data-uc-multiplier=' | append: multiplier | append: replace_src
		endif
		if custom_attributes
			assign replace_src = ' ' | append: custom_attributes | append: ' ' | append: replace_src
		endif
		assign output = input | replace: 'srcset="', 'data-srcset="' | replace: ' src=', replace_src
		echo output
	%}
</span>
